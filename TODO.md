# TODO - Next 10 High-Leverage Actions (Phase 8)

> **Last Updated:** December 29, 2025 18:00 UTC
> **Documentation Recency Validated:** December 29, 2025
> **Generated by:** Claude with temporal metacognition

---

## Phase 7 Complete - Summary

| #   | Action                                                       | Confidence | Subtasks | Status      |
| --- | ------------------------------------------------------------ | ---------- | -------- | ----------- |
| 1   | Consolidate to "strict": true Mode                           | 100%       | 10       | ✅ Complete |
| 2   | Enable noUncheckedIndexedAccess                              | 95%        | 12       | ✅ Complete |
| 3   | Lint Warning Cleanup (221 → 75 warnings)                     | 92%        | 15       | ✅ Complete |
| 4   | Edge Function TypeScript Strict Mode                         | 88%        | 14       | ✅ Complete |
| 5   | Type Coverage Reporting & Monitoring                         | 85%        | 13       | ✅ Complete |
| 6   | Pre-Commit Hook for Type Safety                              | 90%        | 11       | ✅ Complete |
| 7   | TypeScript Project References                                | 82%        | 16       | ✅ Complete |
| 8   | Additional Strict Flags (noPropertyAccessFromIndexSignature) | 87%        | 10       | ✅ Complete |
| 9   | Edge Function Integration Tests                              | 85%        | 16       | ✅ Complete |
| 10  | Type-Safe Environment Variables                              | 93%        | 12       | ✅ Complete |

### Phase 7 Achievements

- **10/10 Actions Complete** ✅
- Type coverage: 98.90%
- 102 new Edge Function integration tests
- TypeScript project references enabled
- TanStack Query 5.90.14, Framer Motion 12.23.26

---

## Phase 8 - Strict Mode Codebase Cleanup

| #   | Action                                 | Confidence | Subtasks | Status  |
| --- | -------------------------------------- | ---------- | -------- | ------- |
| 1   | Re-enable noUnusedLocals/Parameters    | 95%        | 15       | Pending |
| 2   | Re-enable noUncheckedIndexedAccess     | 92%        | 18       | Pending |
| 3   | Re-enable noImplicitReturns            | 90%        | 12       | Pending |
| 4   | Fix React markdown component types     | 88%        | 10       | Pending |
| 5   | Fix AnimatedButton framer-motion types | 85%        | 8        | Pending |
| 6   | Supabase types regeneration            | 93%        | 10       | Pending |
| 7   | Fix stage-handlers type errors         | 87%        | 14       | Pending |
| 8   | Fix use-spec-flow type errors          | 85%        | 16       | Pending |
| 9   | Re-enable pre-commit typecheck         | 90%        | 6        | Pending |
| 10  | GitHub Dependabot vulnerability fixes  | 95%        | 10       | Pending |

---

## Action 1: Re-enable noUnusedLocals/Parameters

**Confidence: 95%** | **Priority: HIGH** | **Effort: Medium**

### Problem

`noUnusedLocals` and `noUnusedParameters` are disabled. Many React components have unused React imports and underscore-prefixed parameters.

### Research Citations

- [TypeScript Compiler Options](https://www.typescriptlang.org/tsconfig#noUnusedLocals) - Official docs
- [React 18 JSX Transform](https://legacy.reactjs.org/blog/2020/09/22/introducing-the-new-jsx-transform.html) - React import no longer required

### Atomic Subtasks

| #    | Task                                                   | Files (≤5)                                      | Est.  |
| ---- | ------------------------------------------------------ | ----------------------------------------------- | ----- |
| 1.1  | Remove unused React imports (AgentCard)                | `src/components/AgentCard.tsx`                  | 5min  |
| 1.2  | Remove unused React imports (DialoguePanel)            | `src/components/DialoguePanel.tsx`              | 5min  |
| 1.3  | Remove unused React imports (error-boundaries)         | `src/components/error-boundaries.tsx`           | 5min  |
| 1.4  | Remove unused React imports (ui folder)                | `src/components/ui/*.tsx`                       | 15min |
| 1.5  | Fix \_isPaused in RoundTracker                         | `src/components/RoundTracker.tsx`               | 5min  |
| 1.6  | Fix \_combinedRef in button.tsx                        | `src/components/ui/button.tsx`                  | 5min  |
| 1.7  | Fix \_props in calendar.tsx                            | `src/components/ui/calendar.tsx`                | 5min  |
| 1.8  | Fix \_dt in dotted-glow-background.tsx                 | `src/components/ui/dotted-glow-background.tsx`  | 5min  |
| 1.9  | Fix \_isPaused, \_pendingResume in use-pause-resume.ts | `src/hooks/spec-generation/use-pause-resume.ts` | 10min |
| 1.10 | Run typecheck to identify remaining                    | Terminal                                        | 5min  |
| 1.11 | Fix remaining unused variables                         | Various files                                   | 30min |
| 1.12 | Re-enable noUnusedLocals in tsconfig                   | `tsconfig.app.json`                             | 2min  |
| 1.13 | Re-enable noUnusedParameters in tsconfig               | `tsconfig.app.json`                             | 2min  |
| 1.14 | Run final typecheck                                    | Terminal                                        | 5min  |
| 1.15 | Update CHANGELOG                                       | `CHANGELOG.md`                                  | 5min  |

---

## Action 2: Re-enable noUncheckedIndexedAccess

**Confidence: 92%** | **Priority: HIGH** | **Effort: High**

### Problem

`noUncheckedIndexedAccess` is disabled. Array/object index access returns `T` instead of `T | undefined`, causing potential runtime errors.

### Research Citations

- [TypeScript 4.1 Release](https://devblogs.microsoft.com/typescript/announcing-typescript-4-1/#no-unchecked-indexed-access)
- [TypeScript Handbook](https://www.typescriptlang.org/tsconfig#noUncheckedIndexedAccess)

### Atomic Subtasks

| #    | Task                                        | Files (≤5)                                     | Est.  |
| ---- | ------------------------------------------- | ---------------------------------------------- | ----- |
| 2.1  | Enable noUncheckedIndexedAccess temporarily | `tsconfig.app.json`                            | 2min  |
| 2.2  | Run typecheck to list all errors            | Terminal                                       | 5min  |
| 2.3  | Fix CollaborativeFlowDiagram currentStage   | `src/components/CollaborativeFlowDiagram.tsx`  | 10min |
| 2.4  | Fix chart.tsx item access                   | `src/components/ui/chart.tsx`                  | 10min |
| 2.5  | Fix dotted-glow-background.tsx d access     | `src/components/ui/dotted-glow-background.tsx` | 10min |
| 2.6  | Fix input-otp.tsx SlotProps access          | `src/components/ui/input-otp.tsx`              | 10min |
| 2.7  | Fix stage-handlers.ts votes undefined       | `src/hooks/spec-generation/stage-handlers.ts`  | 15min |
| 2.8  | Fix use-spec-flow.ts syntheses undefined    | `src/hooks/spec-generation/use-spec-flow.ts`   | 20min |
| 2.9  | Fix use-spec-flow.ts setPendingResume       | `src/hooks/spec-generation/use-spec-flow.ts`   | 15min |
| 2.10 | Fix use-agent-prompts.ts metadata access    | `src/hooks/use-agent-prompts.ts`               | 15min |
| 2.11 | Add type guards for array access patterns   | Various files                                  | 30min |
| 2.12 | Add optional chaining where appropriate     | Various files                                  | 20min |
| 2.13 | Run typecheck to verify all fixed           | Terminal                                       | 5min  |
| 2.14 | Keep noUncheckedIndexedAccess enabled       | `tsconfig.app.json`                            | 2min  |
| 2.15 | Run full test suite                         | Terminal                                       | 10min |
| 2.16 | Run production build                        | Terminal                                       | 5min  |
| 2.17 | Update CHANGELOG                            | `CHANGELOG.md`                                 | 5min  |
| 2.18 | Document array access patterns              | `CLAUDE.md`                                    | 10min |

---

## Action 3: Re-enable noImplicitReturns

**Confidence: 90%** | **Priority: MEDIUM** | **Effort: Low**

### Problem

`noImplicitReturns` is disabled. Functions with conditional returns may not return a value in all code paths.

### Atomic Subtasks

| #    | Task                                  | Files (≤5)                            | Est.  |
| ---- | ------------------------------------- | ------------------------------------- | ----- |
| 3.1  | Enable noImplicitReturns temporarily  | `tsconfig.app.json`                   | 2min  |
| 3.2  | Run typecheck to list all errors      | Terminal                              | 5min  |
| 3.3  | Fix NeumorphicSlider return paths     | `src/components/NeumorphicSlider.tsx` | 10min |
| 3.4  | Review and fix other implicit returns | Various files                         | 30min |
| 3.5  | Add explicit return statements        | Various files                         | 20min |
| 3.6  | Run typecheck to verify               | Terminal                              | 5min  |
| 3.7  | Keep noImplicitReturns enabled        | `tsconfig.app.json`                   | 2min  |
| 3.8  | Run test suite                        | Terminal                              | 10min |
| 3.9  | Run production build                  | Terminal                              | 5min  |
| 3.10 | Update CHANGELOG                      | `CHANGELOG.md`                        | 5min  |
| 3.11 | Document return patterns              | Code comments                         | 10min |
| 3.12 | Add to PR template checklist          | `.github/PULL_REQUEST_TEMPLATE.md`    | 5min  |

---

## Action 4: Fix React Markdown Component Types

**Confidence: 88%** | **Priority: MEDIUM** | **Effort: Medium**

### Problem

`react-markdown` component types in MarkdownComponents.tsx and ChatMessage.tsx have type errors with `ExtraProps` and inline function signatures.

### Research Citations

- [react-markdown v10 API](https://github.com/remarkjs/react-markdown#readme) - Latest component types
- [TypeScript Function Component Types](https://react-typescript-cheatsheet.netlify.app/docs/basic/getting-started/function_components/)

### Atomic Subtasks

| #    | Task                                   | Files (≤5)                                         | Est.  |
| ---- | -------------------------------------- | -------------------------------------------------- | ----- |
| 4.1  | Review react-markdown type definitions | `node_modules/react-markdown`                      | 10min |
| 4.2  | Create proper component prop types     | `src/components/SpecOutput/MarkdownComponents.tsx` | 20min |
| 4.3  | Fix code component inline signature    | `src/components/SpecOutput/MarkdownComponents.tsx` | 15min |
| 4.4  | Fix ChatMessage code component         | `src/components/chat/ChatMessage.tsx`              | 15min |
| 4.5  | Add type exports for reuse             | `src/types/markdown.ts`                            | 10min |
| 4.6  | Run typecheck                          | Terminal                                           | 5min  |
| 4.7  | Run affected component tests           | Terminal                                           | 10min |
| 4.8  | Update CHANGELOG                       | `CHANGELOG.md`                                     | 5min  |
| 4.9  | Add JSDoc comments                     | Various files                                      | 10min |
| 4.10 | Document markdown patterns             | `CLAUDE.md`                                        | 10min |

---

## Action 5: Fix AnimatedButton Framer Motion Types

**Confidence: 85%** | **Priority: MEDIUM** | **Effort: Medium**

### Problem

`AnimatedButton` component has type conflict between React's `onDrag` and framer-motion's `onDrag` handlers.

### Research Citations

- [framer-motion v12 API](https://motion.dev/docs/react-motion-component) - Motion component props
- [Motion Events](https://motion.dev/docs/react-animation#drag) - Drag event handlers

### Atomic Subtasks

| #   | Task                                   | Files (≤5)                     | Est.  |
| --- | -------------------------------------- | ------------------------------ | ----- |
| 5.1 | Review framer-motion HTMLMotionProps   | `node_modules/framer-motion`   | 10min |
| 5.2 | Create proper button motion prop types | `src/components/ui/button.tsx` | 20min |
| 5.3 | Exclude conflicting DOM event handlers | `src/components/ui/button.tsx` | 15min |
| 5.4 | Test button functionality              | Manual testing                 | 10min |
| 5.5 | Run typecheck                          | Terminal                       | 5min  |
| 5.6 | Update CHANGELOG                       | `CHANGELOG.md`                 | 5min  |
| 5.7 | Add JSDoc for AnimatedButton           | `src/components/ui/button.tsx` | 10min |
| 5.8 | Document motion patterns               | `CLAUDE.md`                    | 10min |

---

## Action 6: Supabase Types Regeneration

**Confidence: 93%** | **Priority: HIGH** | **Effort: Low**

### Problem

Supabase types don't include `prompts`, `prompt_versions`, `prompt_usage`, or `specifications` tables. Type errors when accessing these tables.

### Research Citations

- [Supabase CLI Type Generation](https://supabase.com/docs/guides/api/rest/generating-types) - Official docs
- [PostgREST Schema Cache](https://postgrest.org/en/stable/references/schema_cache.html) - How types are derived

### Atomic Subtasks

| #    | Task                                 | Files (≤5)                           | Est.  |
| ---- | ------------------------------------ | ------------------------------------ | ----- |
| 6.1  | Run supabase login                   | Terminal                             | 2min  |
| 6.2  | Run supabase gen types               | Terminal                             | 5min  |
| 6.3  | Verify prompts table in types        | `src/integrations/supabase/types.ts` | 5min  |
| 6.4  | Verify specifications table in types | `src/integrations/supabase/types.ts` | 5min  |
| 6.5  | Update type imports in hooks         | `src/hooks/use-agent-prompts.ts`     | 10min |
| 6.6  | Update type imports in pages         | `src/pages/Specs.tsx`                | 10min |
| 6.7  | Run typecheck                        | Terminal                             | 5min  |
| 6.8  | Update CHANGELOG                     | `CHANGELOG.md`                       | 5min  |
| 6.9  | Document type generation process     | `CLAUDE.md`                          | 10min |
| 6.10 | Add to developer onboarding          | `README.md`                          | 10min |

---

## Action 7: Fix stage-handlers Type Errors

**Confidence: 87%** | **Priority: HIGH** | **Effort: Medium**

### Problem

`stage-handlers.ts:306` has type error: votes array may be undefined but assigned to required array type.

### Atomic Subtasks

| #    | Task                                    | Files (≤5)                                    | Est.  |
| ---- | --------------------------------------- | --------------------------------------------- | ----- |
| 7.1  | Review votes handling in stage-handlers | `src/hooks/spec-generation/stage-handlers.ts` | 15min |
| 7.2  | Add null coalescing for votes           | `src/hooks/spec-generation/stage-handlers.ts` | 10min |
| 7.3  | Update VotingStageResult type           | `src/hooks/spec-generation/stage-handlers.ts` | 10min |
| 7.4  | Fix other undefined array assignments   | `src/hooks/spec-generation/stage-handlers.ts` | 20min |
| 7.5  | Add type guards for stage results       | `src/hooks/spec-generation/stage-handlers.ts` | 15min |
| 7.6  | Run typecheck                           | Terminal                                      | 5min  |
| 7.7  | Run unit tests for stage handlers       | Terminal                                      | 10min |
| 7.8  | Update CHANGELOG                        | `CHANGELOG.md`                                | 5min  |
| 7.9  | Add JSDoc for stage handler types       | `src/hooks/spec-generation/stage-handlers.ts` | 15min |
| 7.10 | Review StageHandlerDeps interface       | `src/hooks/spec-generation/stage-handlers.ts` | 10min |
| 7.11 | Fix addHistory type signature           | Various files                                 | 15min |
| 7.12 | Test all 8 stage handlers               | Manual testing                                | 20min |
| 7.13 | Document stage handler patterns         | `CLAUDE.md`                                   | 10min |
| 7.14 | Add error handling tests                | `src/hooks/spec-generation/__tests__/`        | 20min |

---

## Action 8: Fix use-spec-flow Type Errors

**Confidence: 85%** | **Priority: HIGH** | **Effort: High**

### Problem

Multiple type errors in use-spec-flow.ts: setPendingResume used before declaration, syntheses undefined, type incompatibilities.

### Atomic Subtasks

| #    | Task                                   | Files (≤5)                                    | Est.  |
| ---- | -------------------------------------- | --------------------------------------------- | ----- |
| 8.1  | Fix setPendingResume variable hoisting | `src/hooks/spec-generation/use-spec-flow.ts`  | 15min |
| 8.2  | Fix pendingResume undefined handling   | `src/hooks/spec-generation/use-spec-flow.ts`  | 15min |
| 8.3  | Fix syntheses undefined in lines 144+  | `src/hooks/spec-generation/use-spec-flow.ts`  | 20min |
| 8.4  | Fix addHistory type incompatibility    | `src/hooks/spec-generation/use-spec-flow.ts`  | 15min |
| 8.5  | Fix setCurrentStage type               | `src/hooks/spec-generation/use-spec-flow.ts`  | 10min |
| 8.6  | Update StageHandlerDeps to match       | `src/hooks/spec-generation/stage-handlers.ts` | 15min |
| 8.7  | Review useSpecFlow return types        | `src/hooks/spec-generation/use-spec-flow.ts`  | 10min |
| 8.8  | Run typecheck                          | Terminal                                      | 5min  |
| 8.9  | Run unit tests                         | Terminal                                      | 10min |
| 8.10 | Run integration tests                  | Terminal                                      | 15min |
| 8.11 | Update CHANGELOG                       | `CHANGELOG.md`                                | 5min  |
| 8.12 | Add JSDoc comments                     | `src/hooks/spec-generation/use-spec-flow.ts`  | 15min |
| 8.13 | Document spec flow architecture        | `CLAUDE.md`                                   | 15min |
| 8.14 | Review for race conditions             | `src/hooks/spec-generation/use-spec-flow.ts`  | 20min |
| 8.15 | Add error boundary integration         | `src/hooks/spec-generation/use-spec-flow.ts`  | 15min |
| 8.16 | Test E2E spec generation               | Manual testing                                | 30min |

---

## Action 9: Re-enable Pre-Commit Typecheck

**Confidence: 90%** | **Priority: MEDIUM** | **Effort: Low**

### Problem

Pre-commit typecheck was disabled due to type errors. After fixing Actions 1-8, re-enable for CI quality gates.

### Atomic Subtasks

| #   | Task                            | Files (≤5)          | Est.  |
| --- | ------------------------------- | ------------------- | ----- |
| 9.1 | Verify all type errors fixed    | Terminal            | 10min |
| 9.2 | Re-add typecheck to lint-staged | `package.json`      | 5min  |
| 9.3 | Update pre-commit hook          | `.husky/pre-commit` | 5min  |
| 9.4 | Test pre-commit hook            | Manual testing      | 10min |
| 9.5 | Update CHANGELOG                | `CHANGELOG.md`      | 5min  |
| 9.6 | Document pre-commit workflow    | `CLAUDE.md`         | 10min |

---

## Action 10: GitHub Dependabot Vulnerability Fixes

**Confidence: 95%** | **Priority: HIGH** | **Effort: Medium**

### Problem

GitHub reports 6 vulnerabilities on the default branch (4 moderate, 2 low). These should be addressed.

### Research Citations

- [GitHub Security Advisories](https://github.com/advisories) - CVE database
- [npm audit](https://docs.npmjs.com/cli/v10/commands/npm-audit) - Dependency auditing

### Atomic Subtasks

| #     | Task                               | Files (≤5)         | Est.  |
| ----- | ---------------------------------- | ------------------ | ----- |
| 10.1  | Run npm audit                      | Terminal           | 5min  |
| 10.2  | Review GitHub security alerts      | GitHub web UI      | 10min |
| 10.3  | Identify vulnerable packages       | Terminal           | 5min  |
| 10.4  | Run npm audit fix                  | Terminal           | 5min  |
| 10.5  | Manually update if audit fix fails | `package.json`     | 20min |
| 10.6  | Review breaking changes            | Package changelogs | 30min |
| 10.7  | Run full test suite                | Terminal           | 15min |
| 10.8  | Run production build               | Terminal           | 5min  |
| 10.9  | Update CHANGELOG                   | `CHANGELOG.md`     | 5min  |
| 10.10 | Dismiss fixed Dependabot alerts    | GitHub web UI      | 5min  |

---

## Documentation Recency Check

| Document     | Last Updated | Status  |
| ------------ | ------------ | ------- |
| CLAUDE.md    | Dec 26, 2025 | Current |
| README.md    | Dec 2025     | Current |
| CHANGELOG.md | Dec 29, 2025 | Current |
| TODO.md      | Dec 29, 2025 | Current |
| package.json | Dec 29, 2025 | Current |

### External Documentation Checked

- React 19.2.1 stable (wait for 19.3)
- TypeScript 5.8.3 (blocked by typescript-eslint)
- TanStack Query 5.90.14 ✅
- Framer Motion 12.23.26 ✅
- Node.js 22 LTS (plan upgrade to 24)

---

_Generated with temporal metacognition - December 29, 2025_
